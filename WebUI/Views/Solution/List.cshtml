@using Core.Utils.Pagination
@using Model.Entities
@model PaginationResponse<Solution>
@{
	ViewData["Title"] = "Çözümler";

	int start = Math.Max(1, Model.Page - 2);
	int end = Math.Min(Model.PageCount, Model.Page + 2);

	Guid solutionGroupId = ViewBag.SolutionGroupId ?? Guid.Empty;
}

<div class="page-title">
	<nav class="breadcrumbs py-4">
		<div class="container">
			<ol>
				<li><a href="/">Ana sayfa</a></li>
				<li class="current">Çözümler</li>
			</ol>
		</div>
	</nav>
</div>

<div class="row">
	<div class="col-12">
		<section id="blog-posts" class="blog-posts section">
			<div class="container-xl">
				<div class="row gy-4">
					@if (Model.Data == null || !Model.Data.Any())
					{
						<h4>Herhangi bir çözüm bulunamamaktadı.</h4>
					}
					else
					{
						@foreach (var solution in Model.Data)
						{
							<div class="col-lg-6">
								<article class="d-flex flex-column">
									<div style="height:30vh">
										<img src="@solution.Image" alt="@solution.Name" style="height: 100%; width:100%; object-fit:contain;">
									</div>

									<h2 class="title">
										<a asp-controller="cozum" asp-action="detay" asp-route-Id="@solution.FriendlyUrl">@solution.Name</a>
									</h2>

									@if (solution.SolutionGroup != null)
									{
										<div class="meta-top">
											<ul>
												<li class="d-flex align-items-center">
													<i class="bi bi-tag-fill"></i>
													@solution.SolutionGroup.Name
												</li>
											</ul>
										</div>
									}

									<div class="content d-flex flex-column justify-content-between h-100">
										<p>
											@if (solution.Description.Length > 200 ){
												@solution.Description.Substring(0,200) <span>...</span>
											}
											else
											{
												@solution.Description
											}
										</p>
										<div class="read-more">
											<a asp-controller="cozum" asp-action="detay" asp-route-Id="@solution.FriendlyUrl">
												Detay
												<i class="bi bi-arrow-right ms-2"></i>
											</a>
										</div>
									</div>
								</article>
							</div>

							<script type="application/ld+json">
								{
									"@@context": "https://schema.org",
									"@@type": "Çözümlerimiz",
									"name": "@solution.Name",
									"image": "@solution.Image",
									"url": "@Url.Action("Detail", "Solution", new { Id = solution.FriendlyUrl }, Context.Request.Scheme)",
									"brand": {
										"@@type": "Brand",
										"name": "Express Bilgisyar"
									}
								}
							</script>
						}
					}
				</div>
			</div>
		</section>
			
		@if(Model != null && Model.PageCount > 1)
		{
			<section id="blog-pagination" class="blog-pagination section">
				<div class="container">
					<div class="d-flex justify-content-center">
						<ul>
							@for (int i = start; i <= end; i++)
							{
								if (i == Model.Page)
								{
									<li><a class="active" href="#">@i</a></li>
								}
								else
								{
									<li><a href="@Url.Action("List", new { page = i, solutionGroupId = solutionGroupId })">@i</a></li>
								}
							}

							@if (end < Model.PageCount)
							{
								<li>...</li>
								<li><a href="@Url.Action("List", new { page = Model.PageCount, solutionGroupId = solutionGroupId })">@Model.PageCount</a></li>
							}
						</ul>
					</div>
				</div>
			</section>
		}
	</div>
</div>